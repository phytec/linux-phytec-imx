# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
# Copyright (C) 2021 PHYTEC Messtechnik GmbH
%YAML 1.2
---
$id: http://devicetree.org/schemas/media/i2c/ti,ds90ub953.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: TI DS90UB953 FPD-Link III Serializer

maintainers:
  - Stefan Riedmueller <s.riedmueller@phytec.de>

description: |
  The DS90UB953 Serializer features a MIPI-CSI2 input and a Flat Panel
  Display (FPD) Link III output. It works in combination with a DS90UB954
  Deserializer.

  The MIPI-CSI2 input supports up to 4 lanes.

  The FPD Link III link also encapsulates bidirectional I2C messages between
  the I2C busses connected to serializers and deserializer.

properties:
  '#address-cells':
    const: 1

  '#size-cells':
    const: 0

  compatible:
    const: ti,ds90ub953

  reg:
    description: I2C device address
    maxItems: 1

  gpio-controller: true

  '#gpio-cells':
    const: 2

  clocks:
    maxItems: 1

  clock-names:
    items:
      - const: refclk

  '#clock-cells':
    const: 0

  clock-output-names:
    items:
      - const: clkout_port0
      - const: clkout_port1

  clock-frequency:
    description: |
      Desired frequency for the CLKOUT reference clock
      which can be used as a master clock for a connected
      sensor.
    default: 27000000

  ports:
    type: object
    description: |
      The video connections between image sensor, serializer and deserializer
      are modelled using the OF graph bindings in accordance with the
      video interface bindings defined in
      Documentation/devicetree/bindings/media/video-interfaces.txt.

    properties:
      '#address-cells':
        const: 1

      '#size-cells':
        const: 0

      port@0:
        type: object
        properties:
          reg:
            const: 0

          endpoint:
            type: object

            properties:
              remote-endpoint:
                description: |
                  phandle to the camera sensors remote CSI-2 sink
                  endpoint.

            required:
              - remote-endpoint

        required:
          - reg
          - endpoint

        additionalProperties: false

      port@1:
        type: object
        properties:
          reg:
            const: 1

          endpoint:
            type: object

            properties:
              remote-endpoint:
                description: phandle to the remote deserializers endpoint

            required:
              - remote-endpoint

        required:
          - reg
          - endpoint

        additionalProperties: false

    additionalProperties: false

    required:
      - port@1

required:
  - compatible
  - reg
  - clocks
  - clock-names
  - gpio-controller
  - ports

additionalProperties: false

examples:
  - |
    #include <dt-bindings/gpio/gpio.h>

    i2c@0 {
      #address-cells = <1>;
      #size-cells = <0>;

      fpdlink@18 {
        compatible = "ti,ds90ub953";
        reg = <0x18>;

        clocks = <&ref_clk>;
        clock-names = "refclk";

        #clock-cells = <0>;
        clock-output-names = "clkout_port0";

        gpio-controller;
        #gpio-cells = <2>;

        ports {
          #address-cells = <1>;
          #size-cells = <0>;
          port@0 {
            reg = <0>;
            port0_ep: endpoint {
              remote-endpoint = <&cam0_mipi_ep>;
            };
          };

          port@1 {
            reg = <1>;
            port1_ep: endpoint {
              remote-endpoint = <&fpdiii_out_ep>;
            };
          };
        };
      };
    };
